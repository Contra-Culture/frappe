<DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>frappe.js</title>
    <sctipt type="module" src="o.mjs"></sctipt>
    <script type="module">
      import {Universe, VM} from "./o.mjs"
      const u = new Universe(
        (stream)=> {
          stream("orderReceived", () => {})
          stream("orderConfirmed", () => {})
          stream("orderRejected", () => {})
          stream("orderPackaged", () => {})
          stream("orderDelivered", () => {})
          stream("orderLost", () => {})
        },
        (object) => {
          object( "orderConfirmator",
                  (props) => { },
                  (prop) => {
                    prop()
                    prop()
                    prop()
                  },
                  (reaction) => {
                    reaction("orderReceived", (msg) => { }, ["orderConfirmed", "orderRejected"])
                  } )
          object( "orderPackager",
                  (props) => { },
                  (prop) => {
                    prop("n", () => {  }, () => {  })
                    prop()
                    prop()
                  },
                  (reaction) => {
                    reaction("orderConfirmed", (msg) => { }, ["orderPackaged"])
                  } )
          object( "orderDeliverer",
                  (props) => {},
                  (prop) => {
                    prop()
                    prop()
                    prop()
                  },
                  (reaction) => {
                    reaction("orderPackaged", (msg) => { }, ["orderDelivered", "orderLost"])
                  } )
        }
      )
      u.inspect()
    </script>
    <script type="module" src="app.mjs"></script>
    <script type="module">
      import {App} from "./app.mjs"

      window.app = new App("myApp",
                          window,
                          document.querySelector("#app"),
                          { data: { screen: "someScreen",
                                    somaVal: true,
                                  },
                            children: { "articles": { data: { screen: "anotherScreen",
                                                              anotherVal: false,
                                                            },
                                                      matches: (chunk) => { return chunk === "articles" },                                                      }
                                                    }
                                      }
                         )
      console.log("app: ", app)
    </script>
  </head>
  <body>
    <div id="app"></div>
  </body>
</html>
